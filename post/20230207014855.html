<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>史上最全Remark42评论系统安装教程 | 奥国天空</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">史上最全Remark42评论系统安装教程</h1><a id="logo" href="/.">奥国天空</a><p class="description">Matteo's life record</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">史上最全Remark42评论系统安装教程</h1><div class="post-meta">2023-02-07<span> | </span><span class="category"><a href="/categories/%E2%91%A2IT%E4%B8%96%E7%95%8C/">③IT世界</a><a href="/categories/%E2%91%A2IT%E4%B8%96%E7%95%8C/Blog%E7%9B%B8%E5%85%B3/">Blog相关</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 3.2k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 13</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-Remark42%E4%BB%8B%E7%BB%8D"><span class="toc-text">一. Remark42介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%8A%9F%E8%83%BD"><span class="toc-text">1.1 功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%B3%A8%E9%87%8D%E9%9A%90%E7%A7%81"><span class="toc-text">1.2 注重隐私</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%AE%89%E8%A3%85"><span class="toc-text">二. 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><span class="toc-text">2.1 前提条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%AE%89%E8%A3%85remark42"><span class="toc-text">2.2 安装remark42</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%AE%89%E8%A3%85SSL%E8%AF%81%E4%B9%A6%E6%94%AF%E6%8C%81https"><span class="toc-text">2.3 安装SSL证书支持https</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-%E7%94%B3%E8%AF%B7ssl%E8%AF%81%E4%B9%A6"><span class="toc-text">2.3.1 申请ssl证书</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-%E4%BF%AE%E6%94%B9nginx%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">2.3.2. 修改nginx的配置文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-Remark42-%E5%89%8D%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-text">三. Remark42 前端配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-Remark42-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-text">四. Remark42 服务端配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%AE%9E%E7%8E%B0%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8"><span class="toc-text">4.1 实现开机自启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E9%82%AE%E7%AE%B1%E7%99%BB%E5%BD%95%E5%92%8C%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%94%E7%94%A8%E7%99%BB%E5%BD%95"><span class="toc-text">4.2 邮箱登录和第三方应用登录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E5%8C%BF%E5%90%8D%E7%99%BB%E5%BD%95"><span class="toc-text">4.2.1 匿名登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-Github-%E7%99%BB%E5%BD%95"><span class="toc-text">4.2.2 Github 登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-Twitter-%E7%99%BB%E5%BD%95"><span class="toc-text">4.2.3 Twitter 登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4-Google-%E7%99%BB%E5%BD%95"><span class="toc-text">4.2.4 Google 登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-5-Email-%E7%99%BB%E5%BD%95"><span class="toc-text">4.2.5 Email 登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-6-Teletram-%E7%99%BB%E5%BD%95"><span class="toc-text">4.2.6 Teletram 登录</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E4%B8%80%E4%BA%9B%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-text">五. 一些高级使用技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-SSL%E8%AF%81%E4%B9%A6%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F"><span class="toc-text">5.1 SSL证书自动续期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%AE%9E%E7%8E%B0%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8"><span class="toc-text">5.2 实现开机自启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%A4%9A%E7%BD%91%E7%AB%99%E5%85%B1%E7%94%A8%E4%B8%80%E4%B8%AARemark42%E7%B3%BB%E7%BB%9F"><span class="toc-text">5.3 多网站共用一个Remark42系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-1-%E6%AD%A5%E9%AA%A4%E4%B8%80"><span class="toc-text">5.3.1 步骤一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-%E6%AD%A5%E9%AA%A4%E4%BA%8C"><span class="toc-text">5.3.2 步骤二</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E7%AE%A1%E7%90%86%E8%AF%84%E8%AE%BA"><span class="toc-text">5.4 管理评论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D"><span class="toc-text">5.5 备份和恢复</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-1-%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE"><span class="toc-text">5.5.1 备份数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-2-%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE"><span class="toc-text">5.5.2 恢复数据</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><h2 id="一-Remark42介绍">一. Remark42介绍</h2>
<p>Remark42是一个开源的、轻量级、强大的评论系统。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/umputun/remark42">Remark在Github上的源代码</a></p>
<h3 id="1-1-功能">1.1 功能</h3>
<ul>
<li>支持 Markdown emoji</li>
<li>支持匿名、邮箱登录</li>
<li>支持各种OAuth，如GitHub、Google、Facebook、Twitter、Yandex、</li>
<li>颜值也不错，支持浅色和深色模式，带有树和普通演示文稿的多层嵌套评论</li>
<li>支持数据迁移，可以导入Disqus和WordPress的评论数据</li>
<li>强大的管理功能，管理员可以置顶、删除评论和用户禁言</li>
<li>支持投票，个人标示和验证</li>
<li>支持多种评论排序</li>
<li>图片可以可视化导入</li>
<li>支持最近的评论</li>
<li>支持RSS</li>
<li>支持通知</li>
<li>支持手动备份和自动备份，支持备份数据恢复</li>
<li>没有数据库，存储使用单一文件</li>
<li>支持Docker的部署</li>
<li>支持Linux, Windows和MacOS系统</li>
<li>一套评论系统可以用于多个网站</li>
<li>支持HTTPS的访问</li>
</ul>
<h3 id="1-2-注重隐私">1.2 注重隐私</h3>
<p><a target="_blank" rel="noopener" href="https://www.7benshu.com/post/2019/11/3/">以下注重隐私说明摘自拉斐</a></p>
<ul>
<li>Remark42试图对任何私有或半私有信息非常敏感。</li>
<li>身份验证从身份验证提供程序请求最小可能的范围。他们返回的所有额外信息将立即丢弃，并且不会以任何形式存储。</li>
<li>通常，remark42仅保留用户ID，用户名和头像链接。这些字段均不直接公开-标识和名称进行了- 哈希处理，并附加了头像。</li>
<li>没有任何形式的跟踪。</li>
<li>登录技工使用存储在cookie（httpOnly，安全）中的JWT。第二个cookie（XSRF_TOKEN）是防止CSRF的随机ID。</li>
<li>没有跨站点登录，即无法在运行remark42的独立站点之间分析用户的行为。</li>
<li>不涉及第三方分析服务。</li>
<li>用户可以要求remark42知道的所有信息并导出到gz文件。</li>
<li>支持彻底清除与用户活动有关的所有信息。</li>
<li>Cookie的寿命可以限制为仅会话。</li>
<li>由remark42存储的所有潜在敏感数据都经过哈希处理和加密。</li>
</ul>
<h2 id="二-安装">二. 安装</h2>
<h3 id="2-1-前提条件">2.1 前提条件</h3>
<ul>
<li>有一个独立IP的服务器</li>
<li>有一个域名，并把这域名绑定到上面ip，假定域名为: <strong><a target="_blank" rel="noopener" href="http://remark42.sample.com">remark42.sample.com</a></strong></li>
</ul>
<h3 id="2-2-安装remark42">2.2 安装remark42</h3>
<p>官方提供了两种安装方式，一种是Docker，一种是二进制，这里采用二进制方式，服务器要求低一些。</p>
<p>以下程序在Debian服务器上操作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br><span class="line">wget https://github.com/umputun/remark42/releases/download/v1.11.3/remark42.linux-386.tar.gz</span><br><span class="line">tar -xvf remark42.linux-386.tar.gz</span><br><span class="line">mv remark42.linux-386 /usr/local/bin</span><br><span class="line">/usr/local/bin/remark42.linux-386 server --secret=12345 --url=http://127.0.0.1:8080</span><br></pre></td></tr></table></figure>
<p>这时候打开 <a target="_blank" rel="noopener" href="http://remark42.sample.com:8080/web">http://remark42.sample.com:8080/web</a> ，应该显示如下</p>
<p><img src="https://raw.githubusercontent.com/lthcweb/BlogImg/main/gp/202302071314600.webp" alt="remrk42安装成功"></p>
<p>如果显示上面的图片，说明已经安装成功了，安装详情见<a target="_blank" rel="noopener" href="https://remark42.com/docs/getting-started/installation/">官网</a></p>
<p>安装很简单，但是还不能用，存在两个重要的问题：</p>
<ol>
<li>没有SSL，不支持https</li>
<li>不支持通过Google，Facebook，GitHub和Yandex进行社交登录，也不能邮箱登录，什么作用都没有。<br>
下面来解决这两个问题</li>
</ol>
<h3 id="2-3-安装SSL证书支持https">2.3 安装SSL证书支持https</h3>
<h4 id="2-3-1-申请ssl证书">2.3.1 申请ssl证书</h4>
<p>免费ssl证书一般在<a target="_blank" rel="noopener" href="https://letsencrypt.org/zh-cn/">Let’s Encrypt</a>申请，是一个免费、开放和自动化的证书颁发机构。<br>
我们用 ACME 来申请。</p>
<ol>
<li>切换到root状态，安装并停止nginx。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install nginx</span><br><span class="line">systemctl stop nginx</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>安装socat</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt -y install net-tools socat</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>安装ACME</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl  https://get.acme.sh | sh</span><br></pre></td></tr></table></figure>
<p>安装程序会做以下操作：</p>
<ul>
<li>
<p>自动把 <a target="_blank" rel="noopener" href="http://acme.sh">acme.sh</a> 安装到 home 的.acme.sh目录下，即~/.acme.sh/</p>
</li>
<li>
<p>自动创建一个 bash 的 alias, 方便你的使用: alias acme.sh=~/.acme.sh/acme.sh</p>
</li>
<li>
<p>自动为你创建 cronjob, 每天 0:00 点自动检测所有的证书, 如果快过期了, 需要更新, 则会自动更新证书.</p>
</li>
</ul>
<ol start="4">
<li>更改默认证书</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --set-default-ca --server letsencrypt</span><br></pre></td></tr></table></figure>
<p>acme被ZeroSSL收购，其默认的证书方式为ZeroSSL，但此证书生成时会携带邮箱，因此更换为letsencrypt。</p>
<p>当然，也可以在生成证书时加一个–server参数来决定生成什么证书</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--server letsencrypt</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>生成证书，同时验证域名所有权</li>
</ol>
<p><a target="_blank" rel="noopener" href="http://xn--acme-9s6fu80r.sh">使用acme.sh</a> --issue命令生成证书，同时会验证域名的所有权。 <a target="_blank" rel="noopener" href="http://acme.sh">acme.sh</a> 有两种方式验证：http 和 dns 验证。</p>
<p>验证域名的方法有多种，这里采用自建虚拟webserver的http验证方式，要求服务器没有占用80端口，这也是上面停止nginx的原因。</p>
<p>如果服务器已有80端口的服务，不建议使用自建虚拟webserver，此方式续租时略麻烦需要改造。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --issue -d remark2.sample.com --standalone</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/lthcweb/BlogImg/main/gp/202302071402099.webp" alt="生成并验证证书"></p>
<p>注意：如果需要生成泛域名（*.a.com）的证书，不能使用HTTP认证域名，需要改用DNS认证的方式。</p>
<ol start="6">
<li>copy/安装 证书</li>
</ol>
<p>默认生成的证书都放在安装目录下: ~/.acme.sh/，但是不要在web服务器中直接引用目录下的证书文件，也不要手动拷贝证书文件到具体的web服务器中，手动拷贝会导致以后不能自动更新证书。</p>
<p>正确方式是使用acme.sh的命令安装证书，acme.sh会自动拷贝证书文件到具体目录中，且记录下来，以后自动更新证书时也会执行此拷贝步骤，从而实现更新证书的完全自动化。</p>
<p>命令格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --install-cert -d xxx \</span><br><span class="line">		--cert-file xxx \</span><br><span class="line">		--key-file xxx \</span><br><span class="line">		--fullchain-file xxx\</span><br></pre></td></tr></table></figure>
<p>根据实际情况填入对应的参数，以nginx为例：</p>
<ul>
<li>创建安装证书的位置目录</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/nginx/cert_file</span><br></pre></td></tr></table></figure>
<ul>
<li>安装证书</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --installcert -d remark42.sample.com \</span><br><span class="line">		--key-file   /etc/nginx/cert_file/key.pem  \</span><br><span class="line">		--fullchain-file /etc/nginx/cert_file/fullchain.pem</span><br></pre></td></tr></table></figure>
<h4 id="2-3-2-修改nginx的配置文件">2.3.2. 修改nginx的配置文件</h4>
<ol>
<li>查看nginx配置文件位置</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/lthcweb/BlogImg/main/gp/202302071428099.webp" alt="nginx配置文件位置"></p>
<ul>
<li>查看nginx配置文件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/lthcweb/BlogImg/main/gp/202302071439319.webp" alt="nginx配置文件"></p>
<ol start="2">
<li>修改nginx配置文件</li>
</ol>
<p>修改红框位置中的文件，这里修改<code>/etc/nginx/sites-enabled/default</code>, 用<a target="_blank" rel="noopener" href="https://remark42.com/docs/manuals/nginx/">Remark42官网</a> 给出的格式替换。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen      443;</span><br><span class="line">    server_name remark42.sample.com;</span><br><span class="line">    ssl    on;</span><br><span class="line">    ssl_certificate        /etc/nginx/cert_file/fullchain.pem;</span><br><span class="line">    ssl_certificate_key    /etc/nginx/cert_file/key.pem;</span><br><span class="line"></span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_types text/plain application/json text/css application/javascript application/x-javascript text/javascript text/xml application/xml application/rss+xml application/atom+xml application/rdf+xml;</span><br><span class="line">    gzip_min_length 1000;</span><br><span class="line">    gzip_proxied any;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    location ~ /\.git &#123;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /index.html &#123;</span><br><span class="line">         proxy_redirect          off;</span><br><span class="line">         proxy_set_header        X-Real-IP $remote_addr;</span><br><span class="line">         proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">         proxy_set_header        Host $http_host;</span><br><span class="line">         proxy_pass              http://remark42.sample.com:8080/web/index.html;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">         proxy_redirect          off;</span><br><span class="line">         proxy_set_header        X-Real-IP $remote_addr;</span><br><span class="line">         proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">         proxy_set_header        Host $http_host;</span><br><span class="line">         proxy_pass              http://remark42.sample.com:8080/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    access_log   /var/log/nginx/remark42.log;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name remark2.sample.com</span><br><span class="line">  return      301 https://remark42.sample.com$request_uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>启动nginx 和 remark42</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start nginx</span><br><span class="line">exit # 退出root模式，remark42只需要用户模式</span><br><span class="line">./remark42 server --secret=12345 --url=http://127.0.0.1:8080</span><br></pre></td></tr></table></figure>
<p>这时候打开 <a target="_blank" rel="noopener" href="https://remark42.sample.com/web/%EF%BC%8C==%E4%B8%8D%E9%9C%80%E8%A6%818080%E7%AB%AF%E5%8F%A3%E5%8F%B7==%EF%BC%8C%E5%B0%B1%E8%83%BD%E7%9C%8B%E5%88%B0%EF%BC%9A">https://remark42.sample.com/web/，==不需要8080端口号==，就能看到：</a></p>
<p><img src="https://raw.githubusercontent.com/lthcweb/BlogImg/main/gp/202302071314600.webp" alt="remrk42安装成功"></p>
<p>这时候还能打开 <a target="_blank" rel="noopener" href="http://remark42.sample.com:8080/web/">http://remark42.sample.com:8080/web/</a> ，不过已经不需要了，可以在服务器关闭http流量。</p>
<h2 id="三-Remark42-前端配置">三. Remark42 前端配置</h2>
<ol>
<li>把以下代码嵌入到需要显示评论的地方</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;remark42&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>在适当位置添加以下初始化脚本，如footer之类的地方，和上面代码放一起也行。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var remark_config = &#123;</span><br><span class="line">    host: &#x27;https://remark42.sample.com&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;!function(e,n)&#123;for(var o=0;o&lt;e.length;o++)&#123;var r=n.createElement(&quot;script&quot;),c=&quot;.js&quot;,d=n.head||n.body;&quot;noModule&quot;in r?(r.type=&quot;module&quot;,c=&quot;.mjs&quot;):r.async=!0,r.defer=!0,r.src=remark_config.host+&quot;/web/&quot;+e[o]+c,d.appendChild(r)&#125;&#125;(remark_config.components||[&quot;embed&quot;],document);&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>详细配置在这里 <a target="_blank" rel="noopener" href="https://remark42.com/docs/configuration/frontend/">Remark42前端详细配置</a></p>
<h2 id="四-Remark42-服务端配置">四. Remark42 服务端配置</h2>
<h3 id="4-1-实现开机自启动">4.1 实现开机自启动</h3>
<p>我们需要用系统服务来实现开机自启动，方法如下：</p>
<ol>
<li>建立系统用户 remark42</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -r remark42</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>建立服务目录</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -m 770 /var/www/remark42</span><br><span class="line">chown :remark42 /var/www/remark42</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>建立环境配置文件</li>
</ol>
<p>注意 <code>SECRET</code> <mark>不能使用特殊字符</mark>，只能使用大小写字母和数字。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /var/www/remark42/remark42.conf</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">REMARK_URL=https://remark42.sample.com</span><br><span class="line">SECRET=some_secret_key_phrase_1234</span><br><span class="line">SITE=sample</span><br><span class="line">AUTH_ANON=true</span><br><span class="line">EMOJI=true</span><br></pre></td></tr></table></figure>
<p><code>AUTH_ANON=true</code> 将允许匿名访问和留言。</p>
<ol start="4">
<li>建立系统服务</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/systemd/system/remark42.service</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=remark42 comment engine</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=remark42</span><br><span class="line">Group=remark42</span><br><span class="line">EnvironmentFile=/var/www/remark42/remark42.conf</span><br><span class="line">WorkingDirectory=/var/www/remark42</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=5</span><br><span class="line">ExecStart=/usr/local/bin/remark42.linux-386 server</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>激活和启动系统服务</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable --now remark42</span><br></pre></td></tr></table></figure>
<h3 id="4-2-邮箱登录和第三方应用登录">4.2 邮箱登录和第三方应用登录</h3>
<p>如Github, Google, Telegram, Twitter …</p>
<h4 id="4-2-1-匿名登录">4.2.1 匿名登录</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AUTH_ANON=true</span><br></pre></td></tr></table></figure>
<h4 id="4-2-2-Github-登录">4.2.2 Github 登录</h4>
<ol>
<li>
<p>在 “<strong>OAuth App</strong>”: <a target="_blank" rel="noopener" href="https://github.com/settings/developers">https://github.com/settings/developers</a></p>
</li>
<li>
<p>点击 “<strong>New OAuth App</strong>”</p>
</li>
<li>
<p>输入 “<strong>Application Name</strong>” 和 “<strong>Homepage URL</strong>”<br>
Homepage URL里填上面的域名，如 <a target="_blank" rel="noopener" href="https://remark42.sample.com">https://remark42.sample.com</a></p>
</li>
<li>
<p>在&quot;<strong>Authorization callback URL</strong>&quot; 按 域名 + /auth/github/callback 的格式输入, <a target="_blank" rel="noopener" href="https://remark42.sample.com/auth/github/callback">https://remark42.sample.com/auth/github/callback</a></p>
</li>
<li>
<p>点击 “<strong>Register application</strong>”，得到&quot;Client ID&quot;和 “Client secrets”，填入上面的配置文件 /var/www/remark42/remark42.conf</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /var/www/remark42/remark42.conf</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AUTH_GITHUB_CID=120c550d7e13****************</span><br><span class="line">AUTH_GITHUB_CSEC=107e234ee97b10269be7e40dc84ae26e********</span><br></pre></td></tr></table></figure>
<h4 id="4-2-3-Twitter-登录">4.2.3 Twitter 登录</h4>
<ol>
<li>在 “<strong>OAuth App</strong>”: <a target="_blank" rel="noopener" href="https://developer.twitter.com/en/apps">https://developer.twitter.com/en/apps</a></li>
<li>点击 “<strong>Create an App</strong>” ，填写 App Name</li>
<li>记录好 API Key、API Key Secret 和 Bearer Token</li>
<li>在 “<strong>Dashboard</strong>” - “<strong>User authentication settings</strong>”，点击 “<strong>Set up</strong>”</li>
<li>…后面没记</li>
<li>最后在 Dashboard 里，点击Project App的名字，在 “<strong>Consumer Keys</strong>&quot;处点击&quot;<strong>Regenerate</strong>”，就生成了API Key and Secret，填入上面的配置文件。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AUTH_TWITTER_CID=bTuOD2ZmCKWvQiOil********</span><br><span class="line">AUTH_TWITTER_CSEC=4J2VC53Uu4z4qSF2DIUWfsu22Mg7dvu6LJ0pQ6VO4P********</span><br></pre></td></tr></table></figure>
<h4 id="4-2-4-Google-登录">4.2.4 Google 登录</h4>
<p>Google登录按<a target="_blank" rel="noopener" href="https://remark42.com/docs/configuration/authorization/">官网教程</a> 操作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AUTH_GOOGLE_CID=*********************.apps.googleusercontent.com</span><br><span class="line">AUTH_GOOGLE_CSEC=******************</span><br></pre></td></tr></table></figure>
<h4 id="4-2-5-Email-登录">4.2.5 Email 登录</h4>
<p>使用邮件相关功能，需要一个smtp服务器，这里以<a target="_blank" rel="noopener" href="https://www.sendgrid.com">SendGrid</a> 示例。</p>
<ol>
<li>在SengGrid获取Api Key<br>
在<a target="_blank" rel="noopener" href="https://www.sendgrid.com">SendGrid官网</a> 注册登后：</li>
</ol>
<p><img src="https://raw.githubusercontent.com/lthcweb/BlogImg/main/gp/202302081415414.webp" alt="sendgrid"><br>
<img src="https://raw.githubusercontent.com/lthcweb/BlogImg/main/gp/202302081415415.webp" alt="sendgrid"></p>
<p>记录好这个&quot;<strong>Password</strong>&quot;，填到下面 <code>SMTP_PASSWORD</code> 字段。</p>
<ol start="2">
<li>启用邮箱设置</li>
</ol>
<ul>
<li>要启用任何邮箱功能，下面四个字段必须有：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SMTP_HOST=smtp.sendgrid.net</span><br><span class="line">SMTP_PORT=465</span><br><span class="line">SMTP_TLS=true</span><br><span class="line">SMTP_USERNAME=apikey</span><br><span class="line">SMTP_PASSWORD=SG.9-FfVdzMSoODgml-UTenZg.OtfpYh233r3na9Ss9ii69CCChMtyqbSJfZtBN0cVI4</span><br></pre></td></tr></table></figure>
<ul>
<li>启用邮箱登录验证</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AUTH_EMAIL_ENABLE=true</span><br><span class="line">AUTH_EMAIL_FROM=noreply@matteo.eu.org</span><br><span class="line">AUTH_EMAIL_SUBJ=&quot;在 Matteo.eu.org 留言确认&quot;</span><br><span class="line">AUTH_EMAIL_CONTENT_TYPE=&quot;text/html&quot;  </span><br></pre></td></tr></table></figure>
<ul>
<li>启用用户通知</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NOTIFY_USERS=email</span><br><span class="line">NOTIFY_EMAIL_FROM=noreply@matteo.eu.org</span><br><span class="line">NOTIFY_EMAIL_VERIFICATION_SUBJ=&#x27;邮件确认&#x27;  </span><br></pre></td></tr></table></figure>
<ul>
<li>启用管理员通知</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NOTIFY_ADMINS=email</span><br><span class="line">NOTIFY_EMAIL_FROM=noreply@matteo.eu.org</span><br><span class="line">ADMIN_SHARED_EMAIL=admin@matteo.eu.org</span><br></pre></td></tr></table></figure>
<h4 id="4-2-6-Teletram-登录">4.2.6 Teletram 登录</h4>
<ol>
<li>获取 HTTP API<br>
和<a target="_blank" rel="noopener" href="https://t.me/botfather">@BotFather</a> 聊天</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/newbot</span><br></pre></td></tr></table></figure>
<p>输入独一无二的机器人名字，Telegram就会给出 HTTP API.</p>
<ol start="2">
<li>启用 Telegram 登录</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AUTH_TELEGRAM=true</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>管理员通知</li>
</ol>
<p>创建一个频道，将上面的机器人作为管理员添加到其中，配置文件中设置频道ID。<a target="_blank" rel="noopener" href="https://github.com/GabrielRF/telegram-id#web-channel-id">Telegram私有频道ID获取办法</a> ，ID是13位数字，以<code>-</code>负号开始</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NOTIFY_ADMINS=telegram</span><br><span class="line">NOTIFY_TELEGRAM_CHAN=-100**********</span><br><span class="line">NOTIFY_TYPE=telegram</span><br><span class="line">NOTIFY_TELEGRAM_TOKEN=62*****253:AA***********************************</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>用户通知<br>
暂时不能使用</li>
</ol>
<h2 id="五-一些高级使用技巧">五. 一些高级使用技巧</h2>
<h3 id="5-1-SSL证书自动续期">5.1 SSL证书自动续期</h3>
<p>申请的SSL证书有效期只有几个月，超过后就要续期。<br>
上面 <a href="#2.3.1-%E7%94%B3%E8%AF%B7ssl%E8%AF%81%E4%B9%A6">申请ssl证书</a> 的安装脚本自带自动续期功能。</p>
<h3 id="5-2-实现开机自启动">5.2 实现开机自启动</h3>
<p>见上面 <a href="#4.1-%E5%AE%9E%E7%8E%B0%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8">实现开机自启动</a>。</p>
<h3 id="5-3-多网站共用一个Remark42系统">5.3 多网站共用一个Remark42系统</h3>
<p>从这里得到的方法： <a target="_blank" rel="noopener" href="https://github.com/umputun/remark42/discussions/950">方法来源</a></p>
<h4 id="5-3-1-步骤一">5.3.1 步骤一</h4>
<p>设置前端代码的 <code>site_id</code></p>
<p>网站一：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var remark_config = &#123;</span><br><span class="line">    host: &#x27;https://remark42.sameple.com&#x27;,</span><br><span class="line">    site_id: &#x27;mysite1&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>网站二：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var remark_config = &#123;</span><br><span class="line">    host: &#x27;https://remark42.sameple.com&#x27;,</span><br><span class="line">    site_id: &#x27;mysite2&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-2-步骤二">5.3.2 步骤二</h4>
<p>服务端设置</p>
<ol>
<li>**网站 id 设置 **</li>
</ol>
<ul>
<li>如果用命令行启动，site参数如下</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--site=mysite --site=mysite1 --site=mysite2</span><br></pre></td></tr></table></figure>
<ul>
<li>如果用环境参数启动，</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SITE=mysite,mysite1,mysite2</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><strong>是否跨域设置，可能有以下组合</strong>：</li>
</ol>
<ul>
<li>
<p>不设置任何值：在安装Remark42的同一域和子域上可用。</p>
</li>
<li>
<p><code>ALLOWED_HOSTS</code>设置为一组域，评论仅在列出的域上显示，登录授权在任何地方都不起作用，但在安装 Remark42 的同一域及其子域上可用。<code>self</code> 表示remark所在的域名，这里为 <code>sample.com</code> 。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALLOWED_HOSTS=&#x27;self&#x27;,example1.com,example2.com</span><br></pre></td></tr></table></figure>
<ul>
<li><code>AUTH_SAME_SITE=None</code> : 评论显示在任何域上，登录授权可以在任何地方使用。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AUTH_SAME_SITE=None</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ALLOWED_HOSTS</code>设置为一组域，且<code>AUTH_SAME_SITE=None</code>：评论显示在列出的域上，登录授权将也适用于这些域。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALLOWED_HOSTS=&#x27;self&#x27;,sample1.com,example2.com</span><br><span class="line">AUTH_SAME_SITE=None</span><br></pre></td></tr></table></figure>
<p>详细情况见 <a target="_blank" rel="noopener" href="https://remark42.com/docs/manuals/separate-domain/">官网说明</a></p>
<h3 id="5-4-管理评论">5.4 管理评论</h3>
<ul>
<li>管理员ID在 <code>ADMIN_SHARED_ID</code> 字段设置，可以多个，用 <code>,</code> 隔开。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN_SHARED_ID=github_a0698fa40eexxxxxxxxxxxx,google_0718xxxxxxxxxxxxxxxxxx</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>怎么获得ID？在评论区登录后，点击登录的用户名，会打开个人ID，双击可以选择。</p>
</li>
<li>
<p>管理员在评论区登录后，可以执行管理操作，如删封黑。</p>
</li>
</ul>
<h3 id="5-5-备份和恢复">5.5 备份和恢复</h3>
<h4 id="5-5-1-备份数据">5.5.1 备份数据</h4>
<ul>
<li>自动备份<br>
Remark42 默认在${BACKUP_PATH}(default ./var/backup) 下制作每日备份文件。备份最多${MAX_BACKUP_FILES}（默认 10）。每个备份文件都包含导出和 gzip 压缩的内容，即所有注释。</li>
<li>手动备份手动备份需要设置 <code>ADMIN_PASSWD</code> 并启用 ，注意密码不能使用特殊字符。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN_PASSWD=4ot8kfgahdGFHH3</span><br></pre></td></tr></table></figure>
<p>备份命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./remark42.linux-386 --url=https://remark42.sample.com --secret=some_secret_key_phrase_1234 backup --site=sample --admin-passwd=4ot8kfgahdGFHH3</span><br></pre></td></tr></table></figure>
<h4 id="5-5-2-恢复数据">5.5.2 恢复数据</h4>
<p>恢复数据需要设置 <code>ADMIN_PASSWD</code> 并启用。恢复命令:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./remark42.linux-386 --url=https://remark42.sample.com --secret=some_secret_key_phrase_1234 restore --file=userbackup-matteo-20230208T185724.gz --site=sample --admin-passwd=4ot8kfgahdGFHH3</span><br></pre></td></tr></table></figure>
<p><mark>恢复命令会删除现有的所有评论</mark>，如要合并现在评论，看<a target="_blank" rel="noopener" href="https://remark42.com/docs/backup/restore/">官网教程</a></p>
</div><div class="tags"><a href="/tags/Blog"><i class="fa fa-tag">Blog</i></a><a href="/tags/安装"><i class="fa fa-tag">安装</i></a></div><div class="post-nav"><a class="pre" href="/post/20230208190737.html">基于域名创建无限数量的电子邮件email</a><a class="next" href="/post/20230204195500.html">Github Pages增加discus评论系统</a></div><div id="remark42"></div><script>var remark_config = {
  host: 'https://remark.matteo.eu.org',
  site_id: 'matteo',
  locale: 'zh',
  simple_view: false,
  no_footer: true
}
</script><script>!function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A1%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">②编程语言</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A1%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/">C++</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A2IT%E4%B8%96%E7%95%8C/">③IT世界</a><span class="category-list-count">9</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A2IT%E4%B8%96%E7%95%8C/Blog%E7%9B%B8%E5%85%B3/">Blog相关</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A2IT%E4%B8%96%E7%95%8C/Markdown/">Markdown</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A2IT%E4%B8%96%E7%95%8C/%E5%A5%87%E5%B7%A7%E7%BB%8F%E9%AA%8C/">奇巧经验</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A3%E5%BE%B7%E8%AF%AD%E5%AD%A6%E4%B9%A0/">④德语学习</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A3%E5%BE%B7%E8%AF%AD%E5%AD%A6%E4%B9%A0/%E5%8F%91%E9%9F%B3/">发音</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A3%E5%BE%B7%E8%AF%AD%E5%AD%A6%E4%B9%A0/%E8%AF%AD%E6%B3%95/">语法</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A4%E4%BA%BA%E7%94%9F%E7%99%BE%E5%91%B3/">⑤人生百味</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E2%91%A4%E4%BA%BA%E7%94%9F%E7%99%BE%E5%91%B3/%E8%83%A1%E8%A8%80%E4%B9%B1%E8%AF%AD/">胡言乱语</a><span class="category-list-count">2</span></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/c/" style="font-size: 15px;">c++</a> <a href="/tags/Blog/" style="font-size: 15px;">Blog</a> <a href="/tags/%E5%AE%89%E8%A3%85/" style="font-size: 15px;">安装</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/%E5%9F%9F%E5%90%8D/" style="font-size: 15px;">域名</a> <a href="/tags/email/" style="font-size: 15px;">email</a> <a href="/tags/%E4%BB%A3%E8%AF%8D/" style="font-size: 15px;">代词</a> <a href="/tags/%E5%86%A0%E8%AF%8D/" style="font-size: 15px;">冠词</a> <a href="/tags/%E5%8A%A8%E8%AF%8D/" style="font-size: 15px;">动词</a> <a href="/tags/%E5%90%8D%E8%AF%8D/" style="font-size: 15px;">名词</a> <a href="/tags/%E8%AF%BB%E5%90%8E%E6%84%9F/" style="font-size: 15px;">读后感</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/post/20230211235610.html">读史书有感</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230211215635.html">说同意的时候，并不都代表同意</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230208190737.html">基于域名创建无限数量的电子邮件email</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230207014855.html">史上最全Remark42评论系统安装教程</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230204195500.html">Github Pages增加discus评论系统</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230203150106.html">Markdown常用功能</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230203120406.html">Markdown用Mermaid显示流程图等图形</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230202220406.html">Markdown插入视频</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230201200012.html">德语动词 - 现在时的动词变位</a></li><li class="post-list-item"><a class="post-list-link" href="/post/20230201144333.html">德语代词-人称代词、物主代词、不定代词</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">奥国天空.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>